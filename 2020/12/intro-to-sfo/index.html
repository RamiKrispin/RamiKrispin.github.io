<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.66.0 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Rami Krispin">
<meta name="keywords" content="sfo">
<meta name="description" content="Happy to announce (in one month delay) a new package - sfo, which provides monthly statistics of the air passenger traffic at San Francisco International (SFO) airport. The package is available on CRAN.
Additional information available:
 Source code - https://github.com/RamiKrispin/sfo Package site - https://ramikrispin.github.io/sfo/index.html Vignettes - https://ramikrispin.github.io/sfo/articles Data source - San Francisco Open Data portal  The package provides the following two datasets:">


<meta property="og:description" content="Happy to announce (in one month delay) a new package - sfo, which provides monthly statistics of the air passenger traffic at San Francisco International (SFO) airport. The package is available on CRAN.
Additional information available:
 Source code - https://github.com/RamiKrispin/sfo Package site - https://ramikrispin.github.io/sfo/index.html Vignettes - https://ramikrispin.github.io/sfo/articles Data source - San Francisco Open Data portal  The package provides the following two datasets:">
<meta property="og:type" content="article">
<meta property="og:title" content="Introduction to the sfo Package">
<meta name="twitter:title" content="Introduction to the sfo Package">
<meta property="og:url" content="/2020/12/intro-to-sfo/">
<meta property="twitter:url" content="/2020/12/intro-to-sfo/">
<meta property="og:site_name" content="Rami Krispin">
<meta property="og:description" content="Happy to announce (in one month delay) a new package - sfo, which provides monthly statistics of the air passenger traffic at San Francisco International (SFO) airport. The package is available on CRAN.
Additional information available:
 Source code - https://github.com/RamiKrispin/sfo Package site - https://ramikrispin.github.io/sfo/index.html Vignettes - https://ramikrispin.github.io/sfo/articles Data source - San Francisco Open Data portal  The package provides the following two datasets:">
<meta name="twitter:description" content="Happy to announce (in one month delay) a new package - sfo, which provides monthly statistics of the air passenger traffic at San Francisco International (SFO) airport. The package is available on CRAN.
Additional information available:
 Source code - https://github.com/RamiKrispin/sfo Package site - https://ramikrispin.github.io/sfo/index.html Vignettes - https://ramikrispin.github.io/sfo/articles Data source - San Francisco Open Data portal  The package provides the following two datasets:">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2020-12-28T00:00:00">
  
  
    <meta property="article:modified_time" content="2020-12-28T00:00:00">
  
  
  
    
      <meta property="article:section" content="time-series">
    
  
  
    
      <meta property="article:tag" content="R">
    
      <meta property="article:tag" content="time-series">
    
      <meta property="article:tag" content="sfo">
    
      <meta property="article:tag" content="data">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@Rami_Krispin">


  <meta name="twitter:creator" content="@Rami_Krispin">










  <meta property="og:image" content="https://avatars0.githubusercontent.com/u/12760966?s=400&u=654c914d9df714991b890ea38ac4fce0e55c0d8f&v=4">
  <meta property="twitter:image" content="https://avatars0.githubusercontent.com/u/12760966?s=400&u=654c914d9df714991b890ea38ac4fce0e55c0d8f&v=4">


    <title>Introduction to the sfo Package</title>

    <link rel="icon" href="/favicon.png">
    

    

    <link rel="canonical" href="/2020/12/intro-to-sfo/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet"  href="/css/mystyle.css">
      
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-126702581-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/">Rami Krispin</a>
  </div>
  
    
      <a class="header-right-picture "
         href="/#about">
    
    
    
      
        <img class="header-picture" src="https://avatars0.githubusercontent.com/u/12760966?s=400&amp;u=654c914d9df714991b890ea38ac4fce0e55c0d8f&amp;v=4" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/#about">
          <img class="sidebar-profile-picture" src="https://avatars0.githubusercontent.com/u/12760966?s=400&amp;u=654c914d9df714991b890ea38ac4fce0e55c0d8f&amp;v=4" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Rami Krispin</h4>
        
          <h5 class="sidebar-profile-bio">Time series analysis, forecasting, machine learning, and data visualization</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/projects">
    
      <i class="sidebar-button-icon fa fa-lg fa-code"></i>
      
      <span class="sidebar-button-desc">Projects</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/RamiKrispin">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/Rami_Krispin">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/rami-krispin/">
    
      <i class="sidebar-button-icon fa fa-linkedin-square"></i>
      
      <span class="sidebar-button-desc">LinkedIn</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.r-bloggers.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">R-bloggers</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="5"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Introduction to the sfo Package
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2020-12-28T00:00:00Z">
        
  December 28, 2020

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="/categories/time-series">time-series</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<p>Happy to announce (in one month delay) a new package - <a href="https://ramikrispin.github.io/sfo/index.html">sfo</a>, which provides monthly statistics of the air passenger traffic at San Francisco International (SFO) airport. The package is available on <a href="https://cran.r-project.org/web/packages/sfo/index.html">CRAN</a>.</p>
<p>Additional information available:</p>
<ul>
<li>Source code - <a href="https://github.com/RamiKrispin/sfo" class="uri">https://github.com/RamiKrispin/sfo</a></li>
<li>Package site - <a href="https://ramikrispin.github.io/sfo/index.html" class="uri">https://ramikrispin.github.io/sfo/index.html</a></li>
<li>Vignettes - <a href="https://ramikrispin.github.io/sfo/articles" class="uri">https://ramikrispin.github.io/sfo/articles</a></li>
<li>Data source - San Francisco Open Data <a href="https://datasf.org/opendata/">portal</a></li>
</ul>
<p>The package provides the following two datasets:</p>
<ul>
<li><p><code>sfo_passengers</code> - air traffic passengers statistics</p></li>
<li><p><code>sfo_stats</code> - air traffic landing statistics</p></li>
</ul>
<p>This post focuses on analyzing the <code>sfo_passengers</code> dataset.</p>
<div id="sfo_passengers" class="section level3">
<h3>sfo_passengers</h3>
<p>The sfo_passengers dataset provides monthly statistics about the air traffic passengers in San Francisco International Airport between July 2005 and September 2020. That includes monthly information on the total number of passengers arriving or departing from SFO by airline operator, geographic type (domestic and international), and region (e.g., US, Europe, Mexico, Asia):</p>
<pre class="r"><code>library(sfo)

data(&quot;sfo_passengers&quot;)

str(sfo_passengers)</code></pre>
<pre><code>## &#39;data.frame&#39;:    22576 obs. of  12 variables:
##  $ activity_period            : int  202009 202009 202009 202009 202009 202009 202009 202009 202009 202009 ...
##  $ operating_airline          : chr  &quot;United Airlines&quot; &quot;United Airlines&quot; &quot;United Airlines&quot; &quot;United Airlines&quot; ...
##  $ operating_airline_iata_code: chr  &quot;UA&quot; &quot;UA&quot; &quot;UA&quot; &quot;UA&quot; ...
##  $ published_airline          : chr  &quot;United Airlines&quot; &quot;United Airlines&quot; &quot;United Airlines&quot; &quot;United Airlines&quot; ...
##  $ published_airline_iata_code: chr  &quot;UA&quot; &quot;UA&quot; &quot;UA&quot; &quot;UA&quot; ...
##  $ geo_summary                : chr  &quot;International&quot; &quot;International&quot; &quot;International&quot; &quot;International&quot; ...
##  $ geo_region                 : chr  &quot;Mexico&quot; &quot;Mexico&quot; &quot;Mexico&quot; &quot;Mexico&quot; ...
##  $ activity_type_code         : chr  &quot;Enplaned&quot; &quot;Enplaned&quot; &quot;Enplaned&quot; &quot;Deplaned&quot; ...
##  $ price_category_code        : chr  &quot;Other&quot; &quot;Other&quot; &quot;Other&quot; &quot;Other&quot; ...
##  $ terminal                   : chr  &quot;Terminal 3&quot; &quot;Terminal 3&quot; &quot;International&quot; &quot;International&quot; ...
##  $ boarding_area              : chr  &quot;F&quot; &quot;E&quot; &quot;G&quot; &quot;G&quot; ...
##  $ passenger_count            : int  6712 396 376 6817 3851 3700 71 83 65 45 ...</code></pre>
<p>This dataset enables us to answer questions about the passengers’ flights characteristics at SFO, such as:</p>
<ul>
<li><p>How many passengers traveling every month at SFO airport</p></li>
<li><p>What is the airlines’ operators distribution</p></li>
<li><p>Flights geographic distribution</p></li>
</ul>
<p>The examples below demonstrated how to summarise and visualize the data to answer those types of questions.</p>
<div id="monthly-number-of-passengers" class="section level4">
<h4>Monthly number of passengers</h4>
<p>To see the greater picture, it is always nice to start with a time-series view of the total number of passengers at SFO. Before starting, let’s reformat the activity_period variable into a Date object:</p>
<pre class="r"><code>sfo_passengers$date &lt;- as.Date(paste(substr(sfo_passengers$activity_period, 1,4), 
                                     substr(sfo_passengers$activity_period, 5,6), 
                                     &quot;01&quot;, sep =&quot;/&quot;))</code></pre>
<p>We set the first day of the month as the default day of the date object.</p>
<p>Next, we will use the <strong>dplyr</strong> package to aggregate the data by the date object, and visualize the output with the <strong>plotly</strong> package:</p>
<pre class="r"><code>library(dplyr)
library(plotly)

df_total &lt;- sfo_passengers %&gt;%
  group_by(date) %&gt;%
  summarise(total = sum(passenger_count))

head(df_total)</code></pre>
<pre><code>## # A tibble: 6 x 2
##   date         total
##   &lt;date&gt;       &lt;int&gt;
## 1 2005-07-01 3225769
## 2 2005-08-01 3195866
## 3 2005-09-01 2740553
## 4 2005-10-01 2770715
## 5 2005-11-01 2617333
## 6 2005-12-01 2671797</code></pre>
<pre class="r"><code>plot_ly(data = df_total,
        x = ~ date,
        y = ~ total,
        type = &quot;scatter&quot;,
        mode = &quot;lines&quot;) %&gt;%
  layout(title = &quot;Monthly Air Traffic Passengers at SFO&quot;,
         yaxis = list(title = &quot;Number of Passengers&quot;),
         xaxis = list(title = &quot;Source: San Francisco data portal (DataSF)&quot;))</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"3e9fdca3d63":["function () ","plotlyVisDat"]},"cur_data":"3e9fdca3d63","attrs":{"3e9fdca3d63":{"x":{},"y":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Air Traffic Passengers at SFO","yaxis":{"domain":[0,1],"automargin":true,"title":"Number of Passengers"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Source: San Francisco data portal (DataSF)"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01"],"y":[3225769,3195866,2740553,2770715,2617333,2671797,2448889,2223024,2708778,2773293,2829000,3071396,3227605,3143839,2720100,2834959,2653887,2698200,2507430,2304990,2820085,2869247,3056934,3263621,3382382,3436417,2957530,3129309,2922500,2903637,2670053,2595676,3127387,3029021,3305954,3453751,3603946,3612297,3004720,3124451,2744485,2962937,2644539,2359800,2925918,3024973,3177100,3419595,3649702,3650668,3191526,3249428,2971484,3074209,2785466,2515361,3105958,3139059,3380355,3612886,3765824,3771842,3356365,3490100,3163659,3167124,2883810,2610667,3129205,3200527,3547804,3766323,3935589,3917884,3564970,3602455,3326859,3441693,3211600,2998119,3472440,3563007,3820570,4107195,4284443,4356216,3819379,3844987,3478890,3443039,3204637,2966477,3593364,3604104,3933016,4146797,4176486,4347059,3781168,3910790,3466878,3814984,3432625,3078405,3765504,3881893,4147096,4321833,4499221,4524918,3919072,4059443,3628786,3855835,3550084,3248144,4001521,4021677,4361140,4558511,4801148,4796653,4201394,4374749,4013814,4129052,3748529,3543639,4137679,4172512,4573996,4922125,5168724,5110638,4543759,4571997,4266481,4343369,3897685,3481405,4335287,4425920,4698067,5134110,5496516,5516837,4736005,4868674,4572702,4660504,4190367,3882181,4674035,4713183,5025595,5427144,5692572,5545859,4649100,4861782,4508606,4576449,4156821,3752763,4599189,4692941,5008001,5466688,5612312,5742437,4471408,4824559,4370463,4720992,4241751,3742224,1885466,138817,286570,555119,765274,852578,905992],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>As can be observed in the plot above, as expected, the Covid19 significantly impacted the flights to SFO.</p>
<p>Likewise, we can aggregate the data by the activity type (arrival, departure, transit):</p>
<pre class="r"><code>sfo_passengers %&gt;%
  group_by(date, activity_type_code) %&gt;%
  summarise(total = sum(passenger_count), .groups = &quot;drop&quot;) %&gt;%
  as.data.frame() %&gt;%
  plot_ly(x = ~ date,
          y = ~ total,
          color = ~ activity_type_code,
          type = &quot;scatter&quot;,
          mode = &quot;lines&quot;) %&gt;%
  layout(title = &quot;Monthly Air Traffic Passengers at SFO by Activity Type&quot;,
         yaxis = list(title = &quot;Number of Passengers&quot;),
         xaxis = list(title = &quot;Source: San Francisco data portal (DataSF)&quot;),
         legend = list(x = 0.1, y = 0.9))</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"visdat":{"3e9f4fde9457":["function () ","plotlyVisDat"]},"cur_data":"3e9f4fde9457","attrs":{"3e9f4fde9457":{"x":{},"y":{},"mode":"lines","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Air Traffic Passengers at SFO by Activity Type","yaxis":{"domain":[0,1],"automargin":true,"title":"Number of Passengers"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Source: San Francisco data portal (DataSF)"},"legend":{"x":0.1,"y":0.9},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01"],"y":[1627329,1614468,1353447,1358128,1291602,1297510,1243753,1104323,1341056,1382597,1402609,1480683,1623247,1583441,1348295,1400970,1310983,1304564,1270145,1142067,1390044,1426568,1511517,1589563,1703427,1725895,1470257,1543577,1444998,1412715,1357632,1282855,1547424,1505963,1636765,1702640,1824562,1820030,1497291,1546151,1353890,1463338,1344183,1177412,1460748,1514255,1575534,1673154,1841292,1851368,1581818,1606428,1472565,1514222,1414991,1256290,1551596,1567002,1682836,1763151,1906201,1912714,1661749,1725252,1569727,1565563,1464512,1306930,1557780,1598458,1766258,1854617,1991538,1981339,1772454,1788962,1648305,1690271,1632755,1497324,1724513,1792353,1900287,2024013,2175023,2184914,1916588,1906211,1730629,1689762,1641233,1485424,1792120,1824070,1942381,2046400,2111798,2188184,1892514,1937528,1706441,1893878,1751302,1541774,1879460,1959556,2064092,2135787,2296541,2275155,1970239,2024053,1798119,1913656,1812521,1636133,1999996,2028066,2186927,2247789,2448567,2438908,2101544,2158013,1996103,2039094,1921795,1789766,2066432,2109355,2296057,2422088,2650944,2593874,2287271,2286462,2127669,2132261,2016637,1750071,2153639,2224301,2355351,2519029,2808352,2796449,2358537,2427942,2271196,2270973,2172552,1944768,2320899,2393156,2510276,2658235,2905562,2798782,2340188,2425591,2258229,2235904,2148066,1875859,2278985,2393952,2497897,2665667,2850432,2889791,2247754,2392572,2129479,2313600,2186406,1882350,952557,70582,141790,270718,377145,418398,442442],"mode":"lines","type":"scatter","name":"Deplaned","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01","2020-06-01","2020-07-01","2020-08-01","2020-09-01"],"y":[1569412,1553146,1363140,1384822,1304433,1350000,1182313,1094470,1337770,1371576,1408991,1570272,1583055,1539211,1353586,1417003,1325354,1374406,1217679,1144391,1405982,1420480,1521884,1650947,1656412,1687024,1471094,1568276,1465087,1477301,1297099,1294648,1560380,1504074,1653760,1738334,1761579,1774735,1499313,1569545,1383133,1491674,1290035,1173406,1454796,1500465,1592457,1733926,1798641,1790589,1602188,1633418,1490890,1550460,1359375,1249672,1541956,1559704,1687160,1836349,1846490,1845624,1683566,1752673,1585534,1591589,1409136,1295211,1561541,1593407,1771329,1900610,1932621,1923748,1783953,1804254,1670612,1742295,1571845,1493150,1739289,1764188,1915521,2078066,2103777,2165149,1890812,1934113,1744729,1747550,1558685,1478579,1794640,1774595,1988752,2092041,2060059,2154833,1884343,1957611,1756833,1916814,1675812,1533190,1879974,1916848,2078697,2180660,2195683,2248755,1948420,2034949,1830334,1941106,1736575,1611621,2000314,1992518,2173731,2309593,2351298,2356914,2099362,2216408,2017137,2089548,1825846,1753761,2070896,2062962,2277536,2499842,2517460,2515152,2255391,2285426,2137473,2210506,1880986,1731259,2181301,2201044,2340961,2614453,2686861,2718481,2376714,2440276,2300751,2389342,2016637,1936989,2352210,2318680,2513125,2763785,2779507,2740357,2302919,2430076,2245913,2336093,2003649,1873694,2316520,2294140,2505020,2793918,2754032,2844325,2217062,2425539,2235301,2401871,2050756,1856937,931666,68235,144780,284401,388129,434000,463550],"mode":"lines","type":"scatter","name":"Enplaned","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2005-07-01","2005-08-01","2005-09-01","2005-10-01","2005-11-01","2005-12-01","2006-01-01","2006-02-01","2006-03-01","2006-04-01","2006-05-01","2006-06-01","2006-07-01","2006-08-01","2006-09-01","2006-10-01","2006-11-01","2006-12-01","2007-01-01","2007-02-01","2007-03-01","2007-04-01","2007-05-01","2007-06-01","2007-07-01","2007-08-01","2007-09-01","2007-10-01","2007-11-01","2007-12-01","2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01","2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-02-01","2016-03-01","2016-04-01","2016-05-01","2016-06-01","2016-07-01","2016-08-01","2016-09-01","2016-10-01","2016-11-01","2016-12-01","2017-01-01","2017-02-01","2017-03-01","2017-04-01","2017-05-01","2017-06-01","2017-07-01","2017-08-01","2017-09-01","2017-10-01","2017-11-01","2017-12-01","2018-01-01","2018-02-01","2018-03-01","2018-04-01","2018-05-01","2018-06-01","2018-07-01","2018-08-01","2018-09-01","2018-10-01","2018-11-01","2018-12-01","2019-01-01","2019-02-01","2019-03-01","2019-04-01","2019-05-01","2019-06-01","2019-07-01","2019-08-01","2019-09-01","2019-10-01","2019-11-01","2019-12-01","2020-01-01","2020-02-01","2020-03-01","2020-08-01"],"y":[29028,28252,23966,27765,21298,24287,22823,24231,29952,19120,17400,20441,21303,21187,18219,16986,17550,19230,19606,18532,24059,22199,23533,23111,22543,23498,16179,17456,12415,13621,15322,18173,19583,18984,15429,12777,17805,17532,8116,8755,7462,7925,10321,8982,10374,10253,9109,12515,9769,8711,7520,9582,8029,9527,11100,9399,12406,12353,10359,13386,13133,13504,11050,12175,8398,9972,10162,8526,9884,8662,10217,11096,11430,12797,8563,9239,7942,9127,7000,7645,8638,6466,4762,5116,5643,6153,11979,4663,3532,5727,4719,2474,6604,5439,1883,8356,4629,4042,4311,15651,3604,4292,5511,3441,6070,5489,4307,5386,6997,1008,413,441,333,1073,988,390,1211,1093,482,1129,1283,831,488,328,574,410,888,112,351,195,403,195,320,1612,1097,109,1339,602,62,75,347,575,1755,628,1303,1907,754,456,755,189,1178,424,926,1347,2194,5124,7503,6720,5993,6115,4464,4452,5106,3210,3684,4849,5084,7103,7848,8321,6592,6448,5683,5521,4589,2937,1243,180],"mode":"lines","type":"scatter","name":"Thru / Transit","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="airlines-operators-summary" class="section level4">
<h4>Airlines’ operators summary</h4>
<p>The dataset provides two indicators about the airline company:</p>
<ul>
<li><p><code>operating_airline</code> filed describes the aircraft operator name, and</p></li>
<li><p><code>published_airline</code> filed describes the name of the airline that issues the ticket and books revenue</p></li>
</ul>
<p>In most of the cases it is the same company, in other cases, such as code-sharing operator it may two different companies. Let’s review the characteristics of those variables:<br />
</p>
<pre class="r"><code>length(unique(sfo_passengers$operating_airline))</code></pre>
<pre><code>## [1] 94</code></pre>
<pre class="r"><code>length(unique(sfo_passengers$published_airline))</code></pre>
<pre><code>## [1] 84</code></pre>
<p>You can notice that there are fewer published airlines compared to operating airlines. This potentially means that some operating airlines have lines with code sharing. For simplicity, we will focus on the <code>operating_airline</code> variable.</p>
<p>As 2020 was no ordinary year for most of us, and in particular for the airline industry, we will focus use 2019 to explore the airline operators’ distribution:</p>
<pre class="r"><code>d19 &lt;- sfo_passengers %&gt;% 
  filter(activity_period &gt;= 201901 &amp; activity_period &lt; 202001) %&gt;%
  group_by(published_airline, geo_summary) %&gt;%
  summarise(total = sum(passenger_count), .groups = &quot;drop&quot;)

head(d19)</code></pre>
<pre><code>## # A tibble: 6 x 3
##   published_airline                        geo_summary     total
##   &lt;chr&gt;                                    &lt;chr&gt;           &lt;int&gt;
## 1 ABC Aerolineas S.A. de C.V. dba Interjet International  120633
## 2 Aer Lingus                               International  179430
## 3 Aeromexico                               International  339192
## 4 Air Canada                               International 1123314
## 5 Air China                                International  257998
## 6 Air France                               International  359462</code></pre>
<p>Before we summarize the data by airlines, let’s see the distribution of flights by geo type (domestic vs. international):</p>
<pre class="r"><code>d19 %&gt;% group_by(geo_summary) %&gt;%
  summarise(total_geo = sum(total)) %&gt;%
  plot_ly(labels = ~ geo_summary,
          values = ~ total_geo) %&gt;%
  add_pie(hole = 0.6)</code></pre>
<div id="htmlwidget-3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"visdat":{"3e9f459d3dd2":["function () ","plotlyVisDat"]},"cur_data":"3e9f459d3dd2","attrs":{"3e9f459d3dd2":{"labels":{},"values":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie","hole":0.6,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"labels":["Domestic","International"],"values":[42116019,15302555],"type":"pie","hole":0.6,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Close 75% of the air passenger traffic in SFO during 2019 were domestic. That is 42M passengers out of 57.4M passengers. Let’s use a <a href="https://plotly.com/r/treemaps/">treemap</a> plot to see the distribution of passengers by airline and geo:</p>
<pre class="r"><code> plot_ly(data = d19 %&gt;% filter(geo_summary == &quot;Domestic&quot;),
          labels = ~ published_airline, 
          values = ~ total,
          type = &quot;treemap&quot;,
          parents=  ~geo_summary,
          domain = list(row=0),
          name = &quot;Domestic&quot;,
          textinfo=&quot;label+value+percent parent&quot;) %&gt;%
    add_trace(data = d19 %&gt;% filter(geo_summary == &quot;International&quot;),
            labels = ~ published_airline, 
            values = ~ total,
            type = &quot;treemap&quot;,
            parents=  ~geo_summary,
            domain = list(row=1),
            name = &quot;International&quot;,
            textinfo=&quot;label+value+percent parent&quot;) %&gt;%
    layout(title = &quot;Passengers Distribution During 2019 by Geo&quot;,
      grid=list(columns=1, rows=2))</code></pre>
<div id="htmlwidget-4" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"visdat":{"3e9f7fbcf15d":["function () ","plotlyVisDat"],"3e9f4d8a522f":["function () ","data"]},"cur_data":"3e9f4d8a522f","attrs":{"3e9f7fbcf15d":{"labels":{},"values":{},"parents":{},"domain":{"row":0},"textinfo":"label+value+percent parent","name":"Domestic","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"treemap"},"3e9f4d8a522f":{"labels":{},"values":{},"parents":{},"domain":{"row":1},"textinfo":"label+value+percent parent","name":"International","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"treemap","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Passengers Distribution During 2019 by Geo","grid":{"columns":1,"rows":2},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"labels":["Alaska Airlines","American Airlines","Delta Air Lines","Frontier Airlines","Hawaiian Airlines","JetBlue Airways","Southwest Airlines","Sun Country Airlines","United Airlines"],"values":[6453223,4173488,4529622,476731,366156,1455318,3250038,211427,21200016],"parents":["Domestic","Domestic","Domestic","Domestic","Domestic","Domestic","Domestic","Domestic","Domestic"],"domain":{"row":0},"textinfo":"label+value+percent parent","name":"Domestic","type":"treemap","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null},{"labels":["ABC Aerolineas S.A. de C.V. dba Interjet","Aer Lingus","Aeromexico","Air Canada","Air China","Air France","Air India Limited","Air Italy S.P.A","Air New Zealand","Air Pacific Limited dba Fiji Airways","Alaska Airlines","All Nippon Airways","Asiana Airlines","British Airways","Cathay Pacific","China Airlines","China Eastern","China Southern","COPA Airlines, Inc.","El Al Israel Airlines LTD.","Emirates","EVA Airways","Finnair","French Bee","Hong Kong Airlines Limited","Iberia","Icelandair EHF","Japan Airlines","KLM Royal Dutch Airlines","Korean Air Lines","Lufthansa German Airlines","Norwegian Air Shuttle ASA","Norwegian Air UK Ltd","Philippine Airlines","Qantas Airways","SAS Airlines","Singapore Airlines","Swiss International","TACA International Airlines, S.A.","TAP Air Portugal","Thomas Cook Airlines","Turkish Airlines","United Airlines","Virgin Atlantic","Volaris Airlines","WestJet Airlines","XL Airways France"],"values":[120633,179430,339192,1123314,257998,359462,194040,36267,163058,65689,222654,158248,193476,437051,529929,226404,238138,219079,186505,36022,317696,567890,54407,134331,86997,102168,69829,154747,311490,334020,493851,19575,116319,307436,271237,147577,357093,214657,180559,68876,31750,231731,4979794,289573,3726,146250,22387],"parents":["International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International","International"],"domain":{"row":1},"textinfo":"label+value+percent parent","name":"International","type":"treemap","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="air-traffic-summary" class="section level4">
<h4>Air Traffic Summary</h4>
<p>Finally, it would be interesting to leverage the different categorical variables to create a summary plot with Sankey. We will use the <code>sankey_ly</code> function, a <strong>plotly</strong> wrapper that automatically creates the data transformation, and a Sankey plot with <strong>plotly</strong>. We will rank the top 20 airlines during 2019 and plot the passengers’ distribution by the airline, travel type (domestic or international), travel geo, activity type (deplaned, enplaned, and transit), and fare type (low or other):</p>
<pre class="r"><code>rank &lt;- sfo_passengers %&gt;%
  filter(activity_period &gt;= 201901 &amp; activity_period &lt;= 201912) %&gt;%
  group_by(operating_airline) %&gt;%
  summarise(total = sum(passenger_count), .groups = &quot;drop&quot;) %&gt;%
  arrange(-total) %&gt;%
  slice_head(n = 20) %&gt;%
  select(operating_airline)


sfo_passengers %&gt;%
  filter(activity_period &gt;= 201901 &amp; activity_period &lt;= 201912, operating_airline %in% rank$operating_airline) %&gt;%
  group_by(operating_airline, geo_summary, geo_region, activity_type_code, 
           price_category_code, terminal) %&gt;%
  summarise(total = sum(passenger_count), .groups = &quot;drop&quot;) %&gt;%
  sankey_ly(cat_cols = c(&quot;operating_airline&quot;,&quot;geo_summary&quot;,
                      &quot;geo_region&quot;, &quot;activity_type_code&quot;,
                      &quot;price_category_code&quot;),
          num_col = &quot;total&quot;,
          title = &quot;SFO Air Traffic Passenger Dist. During 2019&quot;)</code></pre>
<div id="htmlwidget-5" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5">{"x":{"visdat":{"3e9f353157b":["function () ","plotlyVisDat"]},"cur_data":"3e9f353157b","attrs":{"3e9f353157b":{"orientation":"h","valueformat":".0f","node":{"label":["Aeromexico","Air Canada","Air France","Alaska Airlines","American Airlines","British Airways","Cathay Pacific","Delta Air Lines","Emirates","EVA Airways","Frontier Airlines","Hawaiian Airlines","Horizon Air","JetBlue Airways","Korean Air Lines","Lufthansa German Airlines","Singapore Airlines","SkyWest Airlines","Southwest Airlines","United Airlines","International","Domestic","Mexico","Canada","Europe","US","Asia","Middle East","Australia / Oceania","Deplaned","Enplaned","Thru / Transit","Other","Low Fare"],"pad":15,"thickness":30,"line":{"color":"black","width":0.5}},"link":{"source":[0,1,2,3,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,17,18,19,19,21,20,20,20,20,20,20,26,26,26,28,28,23,23,23,24,24,22,22,22,27,27,25,25,25,29,29,30,30,31,31],"target":[20,20,20,21,20,21,20,20,21,20,20,21,21,21,21,20,20,20,21,20,21,21,20,25,26,28,23,24,22,27,29,30,31,29,30,29,30,31,29,30,29,30,31,29,30,29,30,31,33,32,33,32,33,32],"value":[339192,922414,359462,5671307,222654,3918421,437051,529929,4431211,317696,567890,476731,366156,324901,1455318,334020,493851,357093,4074547,92113,3250038,17641210,4887681,41609840,3814102,371563,1572388,2444497,1157068,501428,1932967,1880361,774,188886,182677,782360,789972,56,1228156,1216341,575136,581929,3,258537,242891,20736760,20866051,7029,2596824,23105978,2584344,23175878,919,6943]},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"sankey"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"SFO Air Traffic Passenger Dist. During 2019","hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"orientation":"h","valueformat":".0f","node":{"label":["Aeromexico","Air Canada","Air France","Alaska Airlines","American Airlines","British Airways","Cathay Pacific","Delta Air Lines","Emirates","EVA Airways","Frontier Airlines","Hawaiian Airlines","Horizon Air","JetBlue Airways","Korean Air Lines","Lufthansa German Airlines","Singapore Airlines","SkyWest Airlines","Southwest Airlines","United Airlines","International","Domestic","Mexico","Canada","Europe","US","Asia","Middle East","Australia / Oceania","Deplaned","Enplaned","Thru / Transit","Other","Low Fare"],"pad":15,"thickness":30,"line":{"color":"black","width":0.5}},"link":{"source":[0,1,2,3,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,17,18,19,19,21,20,20,20,20,20,20,26,26,26,28,28,23,23,23,24,24,22,22,22,27,27,25,25,25,29,29,30,30,31,31],"target":[20,20,20,21,20,21,20,20,21,20,20,21,21,21,21,20,20,20,21,20,21,21,20,25,26,28,23,24,22,27,29,30,31,29,30,29,30,31,29,30,29,30,31,29,30,29,30,31,33,32,33,32,33,32],"value":[339192,922414,359462,5671307,222654,3918421,437051,529929,4431211,317696,567890,476731,366156,324901,1455318,334020,493851,357093,4074547,92113,3250038,17641210,4887681,41609840,3814102,371563,1572388,2444497,1157068,501428,1932967,1880361,774,188886,182677,782360,789972,56,1228156,1216341,575136,581929,3,258537,242891,20736760,20866051,7029,2596824,23105978,2584344,23175878,919,6943]},"type":"sankey","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="/tags/r/">R</a>

  <a class="tag tag--primary tag--small" href="/tags/time-series/">time-series</a>

  <a class="tag tag--primary tag--small" href="/tags/sfo/">sfo</a>

  <a class="tag tag--primary tag--small" href="/tags/data/">data</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/09/embedding-flexdashboard-in-pkgdown-site/" data-tooltip="Embedding flexdashboard in pkgdown site">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2020/12/intro-to-sfo/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2020/12/intro-to-sfo/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2020/12/intro-to-sfo/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 Rami Krispin. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/09/embedding-flexdashboard-in-pkgdown-site/" data-tooltip="Embedding flexdashboard in pkgdown site">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2020/12/intro-to-sfo/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2020/12/intro-to-sfo/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2020/12/intro-to-sfo/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%2F2020%2F12%2Fintro-to-sfo%2F">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%2F2020%2F12%2Fintro-to-sfo%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=%2F2020%2F12%2Fintro-to-sfo%2F">
          <i class="fa fa-google-plus"></i><span>Share on Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://avatars0.githubusercontent.com/u/12760966?s=400&amp;u=654c914d9df714991b890ea38ac4fce0e55c0d8f&amp;v=4" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Rami Krispin</h4>
    
      <div id="about-card-bio">Time series analysis, forecasting, machine learning, and data visualization</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Data scientist
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Cupertino, CA
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('/images/background.png');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = '\/2020\/12\/intro-to-sfo\/';
          
            this.page.identifier = '\/2020\/12\/intro-to-sfo\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'hugo-tranquilpeak-theme';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  




    
  </body>
</html>

